apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: accountia

resources:
  # Base resources
  - base/namespace.yaml
  - base/configmap.yaml
  - base/secrets.yaml
  
  # Infrastructure
  - infrastructure/mysql.yaml
  - infrastructure/postgres.yaml
  - infrastructure/redis.yaml
  - infrastructure/rabbitmq.yaml
  - infrastructure/keycloak.yaml
  - infrastructure/eureka-server.yaml
  
  # Services
  - services/api-gateway.yaml
  - services/auth-ms.yaml
  - services/microservices.yaml

commonLabels:
  app.kubernetes.io/managed-by: kustomize
  app.kubernetes.io/version: "1.0.0"

# Image transformer - override with: kustomize edit set image accountia/api-gateway=myregistry.io/accountia/api-gateway:v1.0.0
# Or create overlay kustomization.yaml files for different environments
images:
  - name: accountia/eureka-server
    newTag: latest
  - name: accountia/api-gateway
    newTag: latest
  - name: accountia/auth-ms
    newTag: latest
  - name: accountia/business-ms
    newTag: latest
  - name: accountia/invoice-ms
    newTag: latest
  - name: accountia/expense-ms
    newTag: latest
  - name: accountia/client-ms
    newTag: latest
